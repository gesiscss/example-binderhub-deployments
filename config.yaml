service:
  annotations:
    prometheus.io/scrape: 'false'
  #type: ClusterIP
  type: NodePort
  nodePort: 30183

# deployment
nodeSelector:
  staging: worker

resources:
  requests:
    cpu: "0.25"
    memory: 512Mi
  limits:
    cpu: "0.5"
    memory: 512Mi

dind:
  enabled: true
  hostSocketDir: /var/run/dind_auth
  hostLibDir: /var/lib/dind_auth

imageCleaner:
  enabled: false

config:
  BinderHub:
    debug: true
    hub_url: https://notebooks-test.gesis.org/jupyter/

    use_registry: true
    image_prefix: gesiscss/orc-auth-binder-
    build_image: jupyter/repo2docker:9766c954
    per_repo_quota: 100
    build_node_selector:
      build: workers

cors: &cors
  allowOrigin: "*"

jupyterhub:
  custom:
    cors: *cors
  debug:
    enabled: true

  hub:
    service:
      annotations:
        prometheus.io/scrape: 'false'
    baseUrl: /jupyter/
    nodeSelector:
      staging: worker

    extraConfig:
      hub_extra: |
        c.JupyterHub.redirect_to_server = False
        c.JupyterHub.bind_url = 'https://notebooks-test.gesis.org/jupyter/'
        c.JupyterHub.cookie_options = dict(secure=True)
      neverRestart: |
        c.KubeSpawner.extra_pod_config.update({'restart_policy': 'Never'})

    resources:
      requests:
        cpu: "0.25"
        memory: 512Mi
      limits:
        cpu: "0.5"
        memory: 512Mi

  proxy:
    nodeSelector:
      staging: worker
    # https://zero-to-jupyterhub.readthedocs.io/en/stable/security.html#https
    https:
      enablde: false
    service:
      #type: ClusterIP
      type: NodePort
      nodePorts:
        http: 30180
    chp:
      resources:
        requests:
          cpu: "0.1"
          memory: 256Mi
        limits:
          cpu: "0.5"
          memory: 256Mi

  singleuser:
    nodeSelector:
      user: workers
    cpu:
      guarantee: 0.1
      limit: 0.5
    memory:
      guarantee: 512M
      limit: 512M
